@use '@stylesheets/_variables.scss' as v;

.config-set#wiki {
	display: flex;
	position: relative;
	flex-direction: row;
	max-width: calc(100% - 5 * var(--spacing-unit));
	max-height: calc(90vh - var(--spacing-unit));
	width: 100%;
	height: 100%;
	overflow-y: hidden;
	margin-right: 0;
	padding-right: 0;
	@media (max-width: 768px) {
		width: 100%;
		max-width: 100%;
		padding-right: 1rem;
	}

	//color: red;

	.wiki-file {
		//max-height: 100%;
		//color: red;
	}

	.wiki-folder {
		&:is(:focus-within, :focus-visible, :focus) {
			//color: var(--accent-hover);
			//border: 1px solid red;
			//border-bottom: 1px solid var(--accent-hover) !important;
			opacity: 1 !important;

			> * {
				color: var(--text-1);
			}
		}
	}

	#wikiNavigation {
		flex: 0 0 auto;
		max-height: 100%;
		max-width: 30%;
		overflow-y: scroll;
		overflow-x: hidden;
		transition:
			left 10s,
			opacity 150ms,
			transform 0s;
		@media (max-width: 768px) {
			display: block;
			overflow-x: scroll;
			justify-content: center;
			position: absolute;
			max-width: 100%;
			left: 50%;
			transform: translateX(-50%);
			background-color: var(--surface-1);
			padding: var(--spacing-unit) var(--spacing-unit);
			margin: calc(2 * var(--spacing-unit)) 0;
			margin-bottom: 0;
			max-height: 100%;
			height: 80%;
			border: 2px solid var(--text-1);
			box-shadow: 1px 2rem 0.5rem 0.9rem rgba(var(--surface-0), 0);
			border-radius: var(--border-rad);
			padding-right: 0;
			//width: 0;
		}

		.config-group {
			padding: calc(0.5 * var(--spacing-unit));
			@media (max-width: 600px) {
				min-width: 50%;
				padding: var(--spacing-unit);
			}
		}

		.wiki-file {
			max-width: 100%;
			@media (max-width: 600px) {
				min-width: 50%;
			}
		}
		.editor-item:not(.config-group) {
			overflow: hidden;
		}
		.config-group::before {
			//top: 10px
			//word-wrap:
		}
	}
	#navigation_toggle {
		position: absolute;
		z-index: 10;
		color: var(--text-0);
		font-size: 3rem;
		right: calc(2 * var(--spacing-unit));
		transition: all 300ms ease;
		//color: red;
		//top: 10rem;
		@media (max-width: 600px) {
			font-size: 5rem;
			display: block;
			position: absolute;
			top: 0;
			transform: scale(1.5);
		}
		&:hover {
			transform: scale(1.5);
		}
	}
	#wikiView {
		flex: 1 1 auto;
		padding: var(--spacing-unit);
		padding-top: 0;
		//padding-left: 0;
		display: flex;
		flex-direction: column;
		//max-width: 80%;
		width: clamp(100px, 60%, 400px);
		//max-width: calc(100% - 4 * var(--spacing-unit));
		transition:
			all 300ms ease,
			width 2000ms ease;
		@media (max-width: 768px) {
			//padding: 0;
			max-width: 100%;
			width: 100%;
			margin-right: 0;
		}

		#wikiView_title {
			color: var(--accent);
			font-size: 3rem;
			font-weight: bold;
		}

		#wikiView_position {
			padding-top: 0.5rem;
			color: var(--text-2);
			margin-bottom: calc(1.5 * var(--spacing-unit));
		}
	}
}

#wikiNavigation.hidden + #wikiView {
	//transition: ;
	width: 100%;
}

#wikiView_content {
	//markdown styling
	//padding-top: 0;
	overflow: auto;
	font-family: v.$font;
	padding: var(--spacing-unit);
	padding-left: 0;
	word-wrap: break-word;
	//font-size: 1.6rem;
	line-height: 1.65;
	color: var(--text-0);
	max-width: calc(100% - 0 * var(--spacing-unit)) !important;
	max-height: calc(100% - 4rem);
	-webkit-user-select: text !important; /* Chrome, Safari */
	-moz-user-select: text !important; /* Firefox */
	-ms-user-select: text !important; /* IE/Edge */
	user-select: text !important; /* Standard */
	cursor: text;
	@media (max-width: 768px) {
		max-width: 100%;
		width: 100%;
		padding-right: 0;
	}

	> * + *:not(.token) {
		margin-top: var(--spacing-unit);
		max-width: calc(100vw - 4 * var(--spacing-unit));
		margin-right: var(--spacing-unit);
		margin-left: var(--spacing-unit);
	}
	*:not(pre, code, .token) {
		margin-right: var(--spacing-unit);
		margin-left: var(--spacing-unit);
		max-width: calc(100vw - 4 * var(--spacing-unit));
	}

	/* Headings */
	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		font-weight: 600;
		line-height: 1.3;
		//margin-top: calc(var(--spacing-unit) * 2);
		margin-bottom: calc(var(--spacing-unit) * 0.75);
		color: var(--text-0);
	}

	h1 {
		font-size: 3.1rem;
		border-bottom: 1px solid var(--surface-border);
		padding-bottom: 0.4rem;
	}

	h2 {
		font-size: 2.6rem;
	}

	h3 {
		font-size: 2.2rem;
	}

	h4 {
		font-size: 1.95rem;
		color: var(--text-1);
	}

	h5 {
		font-size: 1.75rem;
		color: var(--text-1);
	}

	h6 {
		font-size: 1.6rem;
		color: var(--text-2);
	}

	/* Paragraphs */
	p {
		font-size: 1.6rem;
		color: var(--text-1);
	}

	/* Links */
	a {
		color: var(--accent);
		text-decoration: underline;
		text-underline-offset: 2px;

		&:hover {
			color: var(--accent-hover);
		}

		&:active {
			color: var(--accent-active);
		}
	}

	/* Inline code */
	code {
		font-size: 0.9em;
		background: transparent !important;
		color: var(--accent);
		padding: 0.15em 0.35em;
		border-radius: var(--border-rad);
	}

	/* Code blocks */
	pre {
		background: var(--surface-1);
		border: 1px solid var(--surface-border);
		border-radius: var(--border-rad);
		padding: var(--spacing-unit);
		overflow-x: auto;
		max-width: 90%;

		code {
			background: none;
			padding: 0;
			font-size: 0.9em;
			color: var(--text-0);
		}
	}

	/* Blockquotes */
	blockquote,
	.blockquote {
		background: var(--surface-1);
		border-left: 3px solid var(--accent);
		padding: 0.75rem 1rem;
		border-radius: var(--border-rad);
		color: var(--text-2);

		&.note {
			border-left-color: var(--accent);
			background: var(--surface-2);
		}

		&.tip {
			border-left-color: var(--accent-success);
			background: var(--surface-2);
		}

		&.warning {
			border-left-color: var(--accent-warning);
			background: var(--surface-2);
		}

		&.caution {
			border-left-color: var(--accent-danger);
			background: var(--surface-2);
		}
	}

	/* Lists */
	ul,
	ol {
		padding-left: 1.6rem;
		color: var(--text-1);

		li + li {
			margin-top: 0.3rem;
		}
	}

	/* Tables */
	table {
		width: 100%;
		border-collapse: collapse;
		background: var(--surface-1);
		border-radius: var(--border-rad);
		overflow: hidden;
	}

	th,
	td {
		padding: 0.6rem 0.8rem;
		border-bottom: 1px solid var(--surface-border);
		//max-width: 20ch;
		//word-break: normal;
		////word-wrap: break-word;
		//overflow-wrap: normal;
	}

	th {
		background: var(--surface-0);
		font-weight: 500;
		color: var(--text-0);
	}

	td {
		color: var(--text-1);
	}

	tr:last-child td {
		border-bottom: none;
	}

	/* Horizontal rule */
	hr {
		border: none;
		border-top: 1px solid var(--surface-border);
		margin: calc(var(--spacing-unit) * 2) 0;
	}

	/* Images */
	img {
		max-width: 100%;
		border-radius: var(--border-rad);
		display: block;
	}

	/* Emphasis */
	strong {
		color: var(--text-0);
	}

	em {
		color: var(--text-2);
	}

	/* Utility */
	.muted {
		color: var(--text-disabled);
	}

	.alert-success {
		color: var(--accent-success);
	}

	.alert-warning {
		color: var(--accent-warning);
	}

	.alert-danger {
		color: var(--accent-danger);
	}
}

.tabs-container {
	// Local scope variables for the component
	--tab-transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);

	margin: var(--spacing-unit) 0;
	background-color: var(--surface-1);
	//border: 1px solid var(--surface-border);
	border-radius: var(--border-rad);
	overflow: hidden;
	font-family: var(--font-primary), monospace;

	.tab-nav {
		display: flex;
		background-color: var(--surface-0);
		border-bottom: 1px solid var(--surface-border);
		padding: 0 calc(var(--spacing-unit) * 0.5);
		gap: 0.25rem;
		overflow-x: auto;
		scrollbar-width: none; // Arch users love clean UI

		&::-webkit-scrollbar {
			display: none;
		}
	}

	.tab-btn {
		padding: 0.75rem 1.25rem;
		cursor: pointer;
		background: transparent;
		border: none;
		color: var(--text-3);
		font-family: inherit;
		//font-size: 0.85rem;
		position: relative;
		transition: var(--tab-transition);
		white-space: nowrap;
		flex: 1;

		&:hover {
			color: var(--text-0);
			background-color: rgba(255, 255, 255, 0.05);
		}

		&.active {
			color: var(--accent);

			// Custom underline using pseudo-element
			&::after {
				content: '';
				position: absolute;
				bottom: 0;
				left: 0;
				width: 100%;
				height: 2px;
				background-color: var(--accent);
				box-shadow: 0 0 8px var(--accent);
			}
		}
	}

	.tab-panel {
		padding: var(--spacing-unit);
		background-color: var(--surface-0);
		animation: tabSlideUp 0.3s ease-out;

		// Clean up Nix code blocks inside tabs
		pre {
			max-width: 100% !important;
			margin: var(--spacing-unit) 0;
			background-color: var(--surface-0) !important;
			border: 1px solid var(--surface-border);
		}
	}
}

@keyframes tabSlideUp {
	from {
		opacity: 0;
		transform: translateY(4px);
	}
	to {
		opacity: 1;
		transform: translateY(0);
	}
}

.details-wrapper {
	margin: var(--spacing-unit) 0;
	border: 1px solid var(--surface-border);
	border-radius: var(--border-rad);
	background-color: var(--surface-1);
	overflow: hidden;
	display: flex;
	flex-direction: column;
	max-width: 90%;

	button.details-header {
		/* Reset Button Defaults */
		appearance: none;
		background: var(--surface-1);
		border: none;
		text-align: left;
		width: 100%;

		padding: 0.75rem 1rem;
		cursor: pointer;
		color: var(--accent);
		font-family: v.$font;
		font-weight: 600;
		//font-size: 1rem;
		display: flex;
		align-items: center;
		user-select: none;
		transition: background-color 0.2s ease;

		&::before {
			content: 'ï‘ '; /* Nerd Font Chevron */
			margin-right: 0.75rem;
			transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
			color: var(--text-1);
			display: inline-block;
		}

		&.is-open {
			border-bottom: 0 solid var(--surface-border);
			&::before {
				transform: rotate(90deg);
				color: var(--accent);
			}
		}

		&:hover {
			background-color: var(--surface-0);
			transform: scale(1);
		}
	}

	.details-body {
		padding: var(--spacing-unit);
		background-color: var(--surface-1);

		// Nix code block styling inside
		pre {
			margin: 0;
			background-color: var(--surface-2) !important;
		}
	}
}
